; cartpole parameters
CartPoleParameters
{
    cartMass     1.0
    poleMass     1.0
    poleLength   1.0
    poleWidth    0.05
    gravity      9.8
}

; Time Horizon
mpcTimeHorizon
{
    timehorizon     4.0
    numPartitions   2
}

; Mode sequence
subsystemsSequence
{
    [0]     0
}
; Template mode sequence
templateSubsystemsSequence
{
    [0]     0
}
templateSwitchingTimes
{
}

; SLQ settings
slq
{
    RiccatiIntegratorType        1      ; ODE45 = 1, ADAMS_BASHFORTH = 2, BULIRSCH_STOER = 3, ADAMS_BASHFORTH_MOULTON = 4
    adams_integrator_dt          0.01

    warmStartGSLQ                1
    useLQForDerivatives          0
    displayGradientDescent       0
    tolGradientDescent           1e-2
    acceptableTolGradientDescent 1e-2
    maxIterationGradientDescent  5
    minLearningRateNLP           0.05
    maxLearningRateNLP           0.6
    useAscendingLineSearchNLP    1
    minEventTimeDifference       0.01

    ddp
    {
        maxNumIterations             10     ; 50
        minRelCost                   0.1    ; 0.01
        stateConstraintPenaltyCoeff  100.0
        stateConstraintPenaltyBase   1.1
        meritFunctionRho             50.0
        constraintStepSize           1.0    ; 1.0
        displayInfo                  1
        displayShortSummary          0


        AbsTolODE                    1e-9
        RelTolODE                    1e-6
        minTimeStep                  1e-3
        maxNumStepsPerSecond         100000
        simulationIsConstrained      0
        noStateConstraints           1
        minAbsConstraint1ISE         5e-3
        minRelConstraint1ISE         5e-6
        checkNumericalStability      1

        nThreads                     1

        useFeedbackPolicy            0
        
        strategy                       LINE_SEARCH
        lineSearch
        {
            minStepLength              1.0
            maxStepLength              1.0
            useMakePSD                 1
            addedRiccatiDiagonal       1e-3
        }
    }

    rollout
    {
        AbsTolODE                    1e-9
        RelTolODE                    1e-6
        minTimeStep                  1e-3
        maxNumStepsPerSecond         100000
        checkNumericalStability      1
    }
}

; MPC settings
mpc
{
    runtimeMaxNumIterations     1
    initMaxNumIterations        50
    runtimeMaxStepLength        1.0
    runtimeMinStepLength        1.0
    initMinStepLength           0.1
    initMaxStepLength           1.0
    coldStart                   0
    recedingHorizon             1     ; use receding horizon MPC
    useParallelRiccatiSolver    0     ; use disjoint riccati solver in MP case and recedingHorizon fashion
    solutionTimeWindow          -1    ; maximum [s]
    mpcDesiredFrequency         100   ; [Hz]
    mrtDesiredFrequency         400   ; [Hz]
    debugPrint                  1
}


; initial state
initialState
{
   (0,0) 0.6    ; theta
   (1,0) 0.0    ; x
   (2,0) 0.0    ; theta_dot
   (3,0) 0.0    ; x_dot
}

; state weight matrix
Q
{
    scaling 1e+1

   (0,0)  0.0 ; theta
   (1,1)  0.0 ; x
   (2,2)  10.0  ; theta_dot
   (3,3)  10.0  ; x_dot
}


; control weight matrix
R
{
   scaling 1e+1

   (0,0)  1.0
}


; final state weight matrix
Q_final
{
    scaling 1e+1

   ; orientation
   (0,0)  10.0  ; theta
   (1,1)  10.0  ; x
   (2,2)  10.0  ; theta_dot
   (3,3)  10.0  ; x_dot
}

; final goal
x_final
{
   (0,0)  0.0 ; theta
   (1,0)  0.0 ; x
   (2,0)  0.0 ; theta_dot
   (3,0)  0.0 ; x_dot
}

